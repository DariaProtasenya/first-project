# Модели веток. Простая feature branch модель

Подходы к работе с ветками — это правила, которые описывают, когда и для чего создаются ветки, какие в них коммиты и в какой момент происходит слияние веток.

Рассмотрим три самых популярных подхода — их также принято называть workflow (англ. «рабочий процесс») или сокращённо: **flow**.
* **Feature branch workflow** — простой и самый популярный вариант. Если коротко, в нём для каждого нового изменения создаётся новая ветка, которая позже вливается в `main` с помощью `git merge`.
* **Git flow** — более сложный вариант. Подход похож на feature branch workflow, но в нём создаётся больше веток, а изменения (коммиты) делят на разные типы: исправление, новая функциональность и так далее. Разные типы коммитов попадают в разные ветки.
* **Trunk-based** — популярный в больших компаниях (таких как Яндекс, Google и прочих) подход, который обещает бо́льшую скорость работы в крупных командах.
Этот подход тоже похож на feature branch workflow. Главное отличие в том, что участники проекта вливают (merge) свой код в основную ветку максимально часто. Например, каждый день.

Если аккуратно следовать подходу **feature branch workflow**, то:
* Не будет проблемы «расхождения» веток, ведь новые изменения попадают в `main` через `git merge`, а не через `git push`. Команду merge «разошедшиеся» ветки не смущают, ведь для них она и придумана.
* В ветке `main` всегда рабочая версия проекта. Все «полуфабрикаты» и недоделанные функциональности находятся в `feature`-ветках, пока не будут готовы попасть в `main`.

## Pull (или merge) request

В большинстве команд новые функциональности и исправления попадают в `main` через запрос на слияние (англ. pull request, или merge request). Его так и называют — пул-реквест или мёрж-реквест. В переводе с языка Git это значит: «Вот моя ветка, хочу «вмёржить» её в `main`».

Названия «пул-реквест» и «мёрж-реквест» означают одно и то же. GitHub и BitBucket используют термин «пул-реквест», а GitLab — «мёрж-реквест».

На этапе пул-реквеста можно сделать разные проверки. Например:
* запустить автоматические тесты, которые покажут, не «сломают» ли новые изменения уже существующую в проекте логику;
* просмотреть изменения «глазами» — это называется **code review** (англ. «осмотр», «рецензия кода») или просто **review**.

## Ревью

* Если ревьюеров всё устраивает, они нажимают кнопку **Approve** (англ. «согласовать», «одобрить»). Иногда вместо кнопки используется комментарий-аббревиатура **LGTM** (англ. Looks Good To Me — «на мой взгляд, всё хорошо»).
* После одобрения пул-реквеста его автор (или один из участников проекта) может нажать кнопку **Merge**. Тогда GitHub (или GitLab/BitBucket) вольёт `feature`-ветку в `main`. В зависимости от настроек система также предложит удалить саму `feature`-ветку, потому что она уже не нужна: все изменения есть в `main` после слияния.

## Работа с PR: soft skills

Навыки специалиста принято делить на две группы: hard skills (англ. «жёсткие навыки») и soft skills (англ. «мягкие навыки», «гибкие навыки»).

### Цель ревью — улучшить проект

Все участники процесса рассуждают по-разному, и понять ход мысли другого не всегда легко. Автору пул-реквеста может казаться, что «изменения очевидны и необходимы», а ревьюер может просто не понять, какой была задумка. Это может привести к непониманию и конфликтам.

Важно помнить про конечную цель любого пул-реквеста: внести в проект полезные изменения. Вот несколько общих советов:
* При обсуждении PR старайтесь вносить конструктивные предложения, не стесняйтесь задавать уточняющие вопросы или просить ссылки на практики и примеры.
* Будьте гибки. Одна из целей ревью — сделать код понятным и привести его к стандартам конкретной команды. Иногда вам может показаться, что эти стандарты противоречат вашим знаниям о правильной реализации чего-либо.
* Обращайте внимание как на свой стиль общения, так и на стиль общения других участников. Если вы считаете, что тон комментариев коллег неприемлем, не бойтесь сказать об этом.

### С точки зрения ревьюера

В ходе ревью ревьюеру важно не только показать техническое мастерство, но и проявить свои социально-психологические навыки.

* Ревьюер должен уметь выражать мысли понятно и вежливо, чтобы не вызвать у автора пул-реквеста неприятных эмоций. Многим людям свойственно чувствительно относиться к критике результата своего труда.
* В процессе ревью может понадобиться отклонить часть кода, которую написал разработчик. Важно уметь объяснить, почему это необходимо, а также предложить альтернативное решение. Критика должна применяться исключительно к предлагаемым изменениям, а не к личности их автора.
* Ревьюер должен помнить, что его задача — помочь улучшить качество кода, а не унизить разработчика или показать своё интеллектуальное превосходство. Умение договариваться и слушать собеседника — важные инструменты, которые в этом помогут
* Ревьюер должен быть готов искать компромиссы, а также вести себя профессионально и уважительно в любой ситуации.

### С точки зрения автора пул-реквеста

Автору пул-реквеста не менее, чем ревьюеру, важно развивать и применять софтскилы. Ревьюеры тратят время и усилия, чтобы помочь автору улучшить его код. Поэтому постарайтесь подготовить свой пул-реквест так, чтобы его было легко понять и принять.

* Прежде чем создать пул-реквест, убедитесь, что вы сделали всё необходимое, чтобы подготовить его к ревью. Ещё раз просмотрите изменения самостоятельно, а также проверьте сообщения к коммитам. Также, например, если ваши правки не прошли автотесты, отправлять код на ревью не имеет смысла: ревьюер не примет его.
* Когда вы отправляете пул-реквест, дайте ревьюеру достаточно времени на его изучение. Будьте готовы ответить на любые вопросы, которые могут возникнуть во время ревью.
* Не забывайте, что ревьюеры тоже могут ошибаться. Если вы считаете, что ревьюер неправильно понял ваш код или ваше решение, не бойтесь объяснить свою позицию и предоставить дополнительную информацию.